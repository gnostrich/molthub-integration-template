name: Molthub Integration Template

on:
  workflow_call:  # This makes the workflow reusable by other workflows.
    secrets:
      MOLTHUB_API_KEY:
        required: true
        description: 'API key for authenticating with Moltbook'

jobs:
  integrate-with-moltbook:
    runs-on: ubuntu-latest

    steps:
    - name: Set up Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: Install Molthub
      run: npx molthub@latest install moltbook

    - name: Push Update to Moltbook
      env:
        API_KEY: ${{ secrets.MOLTHUB_API_KEY }}
      run: |
        echo "Sending a post to Moltbook..."
        curl -X POST -H "Authorization: Bearer $API_KEY" \
          -H "Content-Type: application/json" \
          -d '{
                "submolt": "community",
                "title": "Repository Automations with Molthub",
                "content": "Integrating Moltbook easily with this reusable workflow template!"
              }' \
          https://www.moltbook.com/api/v1/posts
